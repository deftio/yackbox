"use strict";function e(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function t(t,s){for(var n=0;n<s.length;n++){var i=s[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,e(i.key),i)}}var s=function(){return e=function e(t,s,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container="string"==typeof t?document.querySelector(t):t instanceof HTMLElement?t:null,this.container||(console.error("Invalid container element for yackbox, creating a new one."),this.container=document.createElement("div")),this.userName="You",this.userAlignment="left",this.completionCallback=s||function(){},this.streamCallback=n||function(){},this.messages=[],this.echo=!0,this.users={},this.initUI()},s=[{key:"addCompletionCallback",value:function(e){this.completionCallback=e||function(){}}},{key:"addStreamCallback",value:function(e){this.streamCallback=e||function(){}}},{key:"addUserMessage",value:function(e){this.addMessage(e,this.userName,this.userAlignment)}},{key:"setDefaultUserName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"You",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";this.userName=e,this.userAlignement=t}},{key:"setUserInputEcho",value:function(e){return this.echo=!!e,this.echo}},{key:"showInputArea",value:function(e){e?(this.inputAreaBox.style.display="",this.messagesContainer.style.height="88%;"):(this.inputAreaBox.style.display="none",this.messagesContainer.style.height="98%")}},{key:"addMessage",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",n=this.messages.length,i={id:n,user:t,content:e,alignment:s,timestamp:(new Date).toUTCString()};this.messages.push(i);var a="left"==s?"yackbox-left":"right"==s?"yackbox-right":"yackbox-center",o='<div class="yackbox-username '.concat(a,'">').concat(t,"</div>"),r='<div class="yackbox-content '.concat(a,'">').concat(e,"</div>"),c='<div id="yackbox-msg-'.concat(n,'" class="yackbox-message ').concat(a,'">').concat(o).concat(r,"</div>");return this.messagesContainer.innerHTML+=c,this.messagesContainer.lastChild.scrollIntoView(),n}},{key:"updateMessageFull",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.messages.find((function(t){return t.id===e}));if(i){t&&(i.content=t),s&&(i.user=s),n&&(i.whichSide=n),i.lastUpdateTimestamp=(new Date).toUTCString();var a=this.container.querySelector("#msg - ${id}");if(a){var o='<div class="yackbox-username">'.concat(i.user,"</div>"),r='<div class="yackbox-content">'.concat(i.content,"</div>");a.innerHTML="".concat(r).concat(o)}return e}}},{key:"appendMessageContent",value:function(e,t){var s=this.messages.find((function(t){return t.id===e}));if(s){t&&(s.content+=t),s.lastUpdateTimestamp=(new Date).toUTCString();var n=this.container.querySelector("#yackbox-msg-".concat(e," .yackbox-content"));return n&&(n.innerHTML=s.content,n.scrollIntoView(!1)),e}}},{key:"removeMessage",value:function(e){var t=this.messages.findIndex((function(t){return t.id===e}));if(t>-1){this.messages.splice(t,1);var s=this.container.querySelector(".yackbox-msg${id}");return s&&s.parentNode.removeChild(s),!0}return!1}},{key:"removeMessageAll",value:function(){this.messages=[]}},{key:"initUI",value:function(){var e=this;this.container.innerHTML='<div class="yackbox-container"> <div class="yackbox-messages"></div> <div class="yackbox-input-area"> <textarea class="yackbox-input-textbox" placeholder="Type here..."></textarea> <div class="yackbox-sep"></div> <button class="yackbox-submit">Send</button> </div> </div>',this.messagesContainer=this.container.querySelector(".yackbox-messages"),this.messagesContainer.scrollIntoView(!1),this.inputAreaBox=this.container.querySelector(".yackbox-input-area"),this.inputTextArea=this.container.querySelector(".yackbox-input-textbox"),this.submitButton=this.container.querySelector(".yackbox-submit");var t=this.inputTextArea,s=this.addMessage.bind(this),n=this.appendMessageContent.bind(this),i=function(e,t,n){return s(e,t,n)},a=function(e,t){return n(e,t)},o=function(){var s=t.value.trim();if(""!==s){var n=e.userName;e.echo&&e.addMessage(s,n,e.userAlignment),t.value="",e.completionCallback({content:s,user:n},i,a)}};t.addEventListener("keydown",(function(e){e.shiftKey&&13===e.keyCode&&(e.preventDefault(),o())})),this.submitButton.addEventListener("click",(function(){o()}))}},{key:"getMessageHistory",value:function(e,t){return this.messages.length<=0||"number"!=typeof e?[]:"number"==typeof t?e<t?this.messages.slice(e,t):this.messages.slice(t,e):(e<0&&(e=this.messages.length+e),[this.messages[e]])}},{key:"getMessageStats",value:function(){return{numMessages:this.messages.length,firstMsgTimestamp:this.messages.length>0?this.messages[0].timestamp:"",lastMsgTimestamp:this.messages.length>0?this.messages[this.messages.length-1].timestamp:""}}}],s&&t(e.prototype,s),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,s,n}();module.exports=s;
//# sourceMappingURL=yackbox.cjs.min.js.map
