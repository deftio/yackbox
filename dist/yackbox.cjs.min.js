"use strict";function e(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function t(t,n){for(var s=0;s<n.length;s++){var i=n[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,e(i.key),i)}}var n=function(){return e=function e(t,n,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container="string"==typeof t?document.querySelector(t):t instanceof HTMLElement?t:null,this.container||(console.error("Invalid container element for yackbox, creating a new one."),this.container=document.createElement("div")),this.userName="You",this.userAlignment="left",this.completionCallback=n||function(){},this.streamCallback=s||function(){},this.messages=[],this.echo=!0,this.users={},this.initUI()},n=[{key:"addCompletionCallback",value:function(e){this.completionCallback=e||function(){}}},{key:"addStreamCallback",value:function(e){this.streamCallback=e||function(){}}},{key:"addUserMessage",value:function(e){this.addMessage(e,this.userName,this.userAlignment)}},{key:"setDefaultUserName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"You",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";this.userName=e,this.userAlignement=t}},{key:"setUserInputEcho",value:function(e){return this.echo=!!e,this.echo}},{key:"showInputArea",value:function(e){e?(this.inputAreaBox.style.display="",this.messagesContainer.style.height="88%;"):(this.inputAreaBox.style.display="none",this.messagesContainer.style.height="98%")}},{key:"addMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",s=this.messages.length,i={id:s,user:t,content:e,alignment:n,timestamp:(new Date).toUTCString()};this.messages.push(i);var a="left"==n?"yackbox-left":"right"==n?"yackbox-right":"yackbox-center",o='<div class="yackbox-username '.concat(a,'">').concat(t,"</div>"),r='<div class="yackbox-content '.concat(a,'">').concat(e,"</div>"),c='<div id="yackbox-msg'.concat(s,'" class="yackbox-message ').concat(a,'">').concat(o).concat(r,"</div>");return this.messagesContainer.innerHTML+=c,this.messagesContainer.lastChild.scrollIntoView(),s}},{key:"updateMessageFull",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.messages.find((function(t){return t.id===e}));if(i){t&&(i.content=t),n&&(i.user=n),s&&(i.whichSide=s),i.lastUpdateTimestamp=(new Date).toUTCString();var a=this.container.querySelector("#msg-".concat(e));if(a){var o='<div class="yackbox-username">'.concat(i.user,"</div>"),r='<div class="yackbox-content">'.concat(i.content,"</div>");a.innerHTML="".concat(r).concat(o)}return e}}},{key:"appendMessageContent",value:function(e,t){var n=this.messages.find((function(t){return t.id===e}));if(n){t&&(n.content+=t),n.lastUpdateTimestamp=(new Date).toUTCString();var s=this.container.querySelector("#yackbox-msg".concat(e," .yackbox-content"));return s&&(s.innerHTML=n.content,s.scrollIntoView(!1)),e}}},{key:"removeMessage",value:function(e){var t=this.messages.findIndex((function(t){return t.id===e}));if(t>-1){this.messages.splice(t,1);var n=this.container.querySelector(".yackbox-msg".concat(e));return n&&n.parentNode.removeChild(n),!0}return!1}},{key:"removeMessageAll",value:function(){this.messages=[]}},{key:"initUI",value:function(){var e=this;this.container.innerHTML='\n            <div class="yackbox-container">\n                <div class="yackbox-messages"></div>\n                <div class="yackbox-input-area">\n                    <textarea class="yackbox-input-textbox" placeholder="Type here..."></textarea>\n                    <div class="yackbox-sep"></div>\n                    <button class="yackbox-submit">Send</button>\n                </div>\n            </div>\n        ',this.messagesContainer=this.container.querySelector(".yackbox-messages"),this.messagesContainer.scrollIntoView(!1),this.inputAreaBox=this.container.querySelector(".yackbox-input-area"),this.inputTextArea=this.container.querySelector(".yackbox-input-textbox"),this.submitButton=this.container.querySelector(".yackbox-submit");var t=this.inputTextArea,n=this.addMessage.bind(this),s=this.appendMessageContent.bind(this),i=function(e,t,s){return n(e,t,s)},a=function(e,t){return s(e,t)},o=function(){var n=t.value.trim();if(""!==n){var s=e.userName;e.echo&&e.addMessage(n,s,e.userAlignment),t.value="",e.completionCallback({content:n,user:s},i,a)}};t.addEventListener("keydown",(function(e){e.shiftKey&&13===e.keyCode&&(e.preventDefault(),o())})),this.submitButton.addEventListener("click",(function(){o()}))}},{key:"getMessageHistory",value:function(e,t){return this.messages.length<=0||"number"!=typeof e?[]:"number"==typeof t?e<t?this.messages.slice(e,t):this.messages.slice(t,e):(e<0&&(e=this.messages.length+e),[this.messages[e]])}},{key:"getMessageStats",value:function(){return{numMessages:this.messages.length,numUsers:this.user.keys().length,firstMsgTimestamp:this.messages.length>0?this.messages[0].timestamp:"",lastMsgTimestamp:this.messages.length>0?this.messages[this.messages.length-1].timestamp:""}}}],n&&t(e.prototype,n),s&&t(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,s}();module.exports=n;
//# sourceMappingURL=yackbox.cjs.min.js.map
